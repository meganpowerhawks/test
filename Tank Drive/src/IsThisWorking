This is an attempt to get this actually right for the first time